{"cells":[{"cell_type":"markdown","metadata":{"id":"W7W_WbLoH1Z_"},"source":["## Drive Loading..."]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18219,"status":"ok","timestamp":1623511241548,"user":{"displayName":"Edoardo Gruppi","photoUrl":"","userId":"08031410637981645487"},"user_tz":-120},"id":"K5wFWddJGEMM","outputId":"e407e19b-59d5-4dc2-8cc1-dc73d1f02c38"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n","/content/drive/MyDrive/Università/Models/Yasonik\n","DataPostprocessing.py  main.py\t\t\t\t      README.md\n","DataPreprocessing.py   Miniconda3-py37_4.8.2-Linux-x86_64.sh  requirements.txt\n","Datasets\t       Model\t\t\t\t      Results\n","Generator.py\t       Modules\t\t\t\t      Vocab\n","LSTM.py\t\t       __pycache__\n","Sat Jun 12 15:20:41 2021       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 465.27       Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   52C    P8    10W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["from google.colab import drive\n","drive.mount(\"/content/drive\")\n","% cd '/content/drive/MyDrive/Università/Models/Yasonik'\n","! ls\n","! nvidia-smi"]},{"cell_type":"markdown","metadata":{"id":"pGO589y9H6zX"},"source":["## Environment Setup"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24910,"status":"ok","timestamp":1623511266451,"user":{"displayName":"Edoardo Gruppi","photoUrl":"","userId":"08031410637981645487"},"user_tz":-120},"id":"uyfFc8VufUyl","outputId":"8d156d1d-b547-4da8-d90c-b59784c4d91a"},"outputs":[{"name":"stdout","output_type":"stream","text":["PREFIX=/usr/local\n","Unpacking payload ...\n","Collecting package metadata (current_repodata.json): - \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Solving environment: - \u0008\u0008done\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - _libgcc_mutex==0.1=main\n","    - asn1crypto==1.3.0=py37_0\n","    - ca-certificates==2020.1.1=0\n","    - certifi==2019.11.28=py37_0\n","    - cffi==1.14.0=py37h2e261b9_0\n","    - chardet==3.0.4=py37_1003\n","    - conda-package-handling==1.6.0=py37h7b6447c_0\n","    - conda==4.8.2=py37_0\n","    - cryptography==2.8=py37h1ba5d50_0\n","    - idna==2.8=py37_0\n","    - ld_impl_linux-64==2.33.1=h53a641e_7\n","    - libedit==3.1.20181209=hc058e9b_0\n","    - libffi==3.2.1=hd88cf55_4\n","    - libgcc-ng==9.1.0=hdf63c60_0\n","    - libstdcxx-ng==9.1.0=hdf63c60_0\n","    - ncurses==6.2=he6710b0_0\n","    - openssl==1.1.1d=h7b6447c_4\n","    - pip==20.0.2=py37_1\n","    - pycosat==0.6.3=py37h7b6447c_0\n","    - pycparser==2.19=py37_0\n","    - pyopenssl==19.1.0=py37_0\n","    - pysocks==1.7.1=py37_0\n","    - python==3.7.6=h0371630_2\n","    - readline==7.0=h7b6447c_5\n","    - requests==2.22.0=py37_1\n","    - ruamel_yaml==0.15.87=py37h7b6447c_0\n","    - setuptools==45.2.0=py37_0\n","    - six==1.14.0=py37_0\n","    - sqlite==3.31.1=h7b6447c_0\n","    - tk==8.6.8=hbc83047_0\n","    - tqdm==4.42.1=py_0\n","    - urllib3==1.25.8=py37_0\n","    - wheel==0.34.2=py37_0\n","    - xz==5.2.4=h14c3975_4\n","    - yaml==0.1.7=had09818_2\n","    - zlib==1.2.11=h7b6447c_3\n","\n","\n","The following NEW packages will be INSTALLED:\n","\n","  _libgcc_mutex      pkgs/main/linux-64::_libgcc_mutex-0.1-main\n","  asn1crypto         pkgs/main/linux-64::asn1crypto-1.3.0-py37_0\n","  ca-certificates    pkgs/main/linux-64::ca-certificates-2020.1.1-0\n","  certifi            pkgs/main/linux-64::certifi-2019.11.28-py37_0\n","  cffi               pkgs/main/linux-64::cffi-1.14.0-py37h2e261b9_0\n","  chardet            pkgs/main/linux-64::chardet-3.0.4-py37_1003\n","  conda              pkgs/main/linux-64::conda-4.8.2-py37_0\n","  conda-package-han~ pkgs/main/linux-64::conda-package-handling-1.6.0-py37h7b6447c_0\n","  cryptography       pkgs/main/linux-64::cryptography-2.8-py37h1ba5d50_0\n","  idna               pkgs/main/linux-64::idna-2.8-py37_0\n","  ld_impl_linux-64   pkgs/main/linux-64::ld_impl_linux-64-2.33.1-h53a641e_7\n","  libedit            pkgs/main/linux-64::libedit-3.1.20181209-hc058e9b_0\n","  libffi             pkgs/main/linux-64::libffi-3.2.1-hd88cf55_4\n","  libgcc-ng          pkgs/main/linux-64::libgcc-ng-9.1.0-hdf63c60_0\n","  libstdcxx-ng       pkgs/main/linux-64::libstdcxx-ng-9.1.0-hdf63c60_0\n","  ncurses            pkgs/main/linux-64::ncurses-6.2-he6710b0_0\n","  openssl            pkgs/main/linux-64::openssl-1.1.1d-h7b6447c_4\n","  pip                pkgs/main/linux-64::pip-20.0.2-py37_1\n","  pycosat            pkgs/main/linux-64::pycosat-0.6.3-py37h7b6447c_0\n","  pycparser          pkgs/main/linux-64::pycparser-2.19-py37_0\n","  pyopenssl          pkgs/main/linux-64::pyopenssl-19.1.0-py37_0\n","  pysocks            pkgs/main/linux-64::pysocks-1.7.1-py37_0\n","  python             pkgs/main/linux-64::python-3.7.6-h0371630_2\n","  readline           pkgs/main/linux-64::readline-7.0-h7b6447c_5\n","  requests           pkgs/main/linux-64::requests-2.22.0-py37_1\n","  ruamel_yaml        pkgs/main/linux-64::ruamel_yaml-0.15.87-py37h7b6447c_0\n","  setuptools         pkgs/main/linux-64::setuptools-45.2.0-py37_0\n","  six                pkgs/main/linux-64::six-1.14.0-py37_0\n","  sqlite             pkgs/main/linux-64::sqlite-3.31.1-h7b6447c_0\n","  tk                 pkgs/main/linux-64::tk-8.6.8-hbc83047_0\n","  tqdm               pkgs/main/noarch::tqdm-4.42.1-py_0\n","  urllib3            pkgs/main/linux-64::urllib3-1.25.8-py37_0\n","  wheel              pkgs/main/linux-64::wheel-0.34.2-py37_0\n","  xz                 pkgs/main/linux-64::xz-5.2.4-h14c3975_4\n","  yaml               pkgs/main/linux-64::yaml-0.1.7-had09818_2\n","  zlib               pkgs/main/linux-64::zlib-1.2.11-h7b6447c_3\n","\n","\n","Preparing transaction: | \u0008\u0008/ \u0008\u0008- \u0008\u0008done\n","Executing transaction: | \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","installation finished.\n","WARNING:\n","    You currently have a PYTHONPATH environment variable set. This may cause\n","    unexpected behavior when running the Python interpreter in Miniconda3.\n","    For best results, please verify that your PYTHONPATH only points to\n","    directories of packages that are compatible with the Python interpreter\n","    in Miniconda3: /usr/local\n"]}],"source":["################################################################################\n","# INSTALL CONDA ON GOOGLE COLAB\n","################################################################################\n","import os\n","import sys\n","if not os.path.exists('Miniconda3-py37_4.8.2-Linux-x86_64.sh'):\n","    ! wget https://repo.anaconda.com/miniconda/Miniconda3-py37_4.8.2-Linux-x86_64.sh\n","! chmod +x Miniconda3-py37_4.8.2-Linux-x86_64.sh\n","! bash ./Miniconda3-py37_4.8.2-Linux-x86_64.sh -b -f -p /usr/local\n","sys.path.append('/usr/local/lib/python3.7/site-packages/')"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":230104,"status":"ok","timestamp":1623511496546,"user":{"displayName":"Edoardo Gruppi","photoUrl":"","userId":"08031410637981645487"},"user_tz":-120},"id":"QD319lDvf6Xp","outputId":"0e76faed-5b47-4e57-b159-8f54a07921cd"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting package metadata (current_repodata.json): - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008done\n","Solving environment: / \u0008\u0008- \u0008\u0008\\ \u0008\u0008done\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - cudnn==7.6.5\n","\n","\n","The following packages will be downloaded:\n","\n","    package                    |            build\n","    ---------------------------|-----------------\n","    ca-certificates-2021.5.25  |       h06a4308_1         112 KB\n","    certifi-2021.5.30          |   py37h06a4308_0         139 KB\n","    conda-4.10.1               |   py37h06a4308_1         2.9 MB\n","    cudatoolkit-10.2.89        |       hfd86e86_1       365.1 MB\n","    cudnn-7.6.5                |       cuda10.2_0       184.3 MB\n","    openssl-1.1.1k             |       h27cfd23_0         2.5 MB\n","    ------------------------------------------------------------\n","                                           Total:       555.0 MB\n","\n","The following NEW packages will be INSTALLED:\n","\n","  cudatoolkit        pkgs/main/linux-64::cudatoolkit-10.2.89-hfd86e86_1\n","  cudnn              pkgs/main/linux-64::cudnn-7.6.5-cuda10.2_0\n","\n","The following packages will be UPDATED:\n","\n","  ca-certificates                                2020.1.1-0 --\u003e 2021.5.25-h06a4308_1\n","  certifi                                 2019.11.28-py37_0 --\u003e 2021.5.30-py37h06a4308_0\n","  conda                                        4.8.2-py37_0 --\u003e 4.10.1-py37h06a4308_1\n","  openssl                                 1.1.1d-h7b6447c_4 --\u003e 1.1.1k-h27cfd23_0\n","\n","\n","\n","Downloading and Extracting Packages\n","conda-4.10.1         | 2.9 MB    | : 100% 1.0/1 [00:00\u003c00:00,  5.41it/s]\n","openssl-1.1.1k       | 2.5 MB    | : 100% 1.0/1 [00:00\u003c00:00,  1.74it/s]\n","certifi-2021.5.30    | 139 KB    | : 100% 1.0/1 [00:00\u003c00:00, 19.03it/s]\n","cudatoolkit-10.2.89  | 365.1 MB  | : 100% 1.0/1 [00:16\u003c00:00, 16.78s/it]              \n","ca-certificates-2021 | 112 KB    | : 100% 1.0/1 [00:00\u003c00:00,  1.45it/s]\n","cudnn-7.6.5          | 184.3 MB  | : 100% 1.0/1 [00:19\u003c00:00, 19.52s/it]               \n","Preparing transaction: / \u0008\u0008done\n","Verifying transaction: \\ \u0008\u0008| \u0008\u0008done\n","Executing transaction: - \u0008\u0008done\n","Collecting package metadata (current_repodata.json): - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008done\n","Solving environment: / \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008done\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - cudatoolkit=10.2\n","    - pytorch\n","    - torchaudio\n","    - torchvision\n","\n","\n","The following packages will be downloaded:\n","\n","    package                    |            build\n","    ---------------------------|-----------------\n","    blas-1.0                   |              mkl           6 KB\n","    bzip2-1.0.8                |       h7b6447c_0          78 KB\n","    ffmpeg-4.3                 |       hf484d3e_0         9.9 MB  pytorch\n","    freetype-2.10.4            |       h5ab3b9f_0         596 KB\n","    gmp-6.2.1                  |       h2531618_2         539 KB\n","    gnutls-3.6.15              |       he1e5248_0         1.0 MB\n","    intel-openmp-2021.2.0      |     h06a4308_610         1.3 MB\n","    jpeg-9b                    |       h024ee3a_2         214 KB\n","    lame-3.100                 |       h7b6447c_0         323 KB\n","    lcms2-2.12                 |       h3be6417_0         312 KB\n","    libiconv-1.15              |       h63c8f33_5         721 KB\n","    libidn2-2.3.1              |       h27cfd23_0          85 KB\n","    libpng-1.6.37              |       hbc83047_0         278 KB\n","    libtasn1-4.16.0            |       h27cfd23_0          58 KB\n","    libtiff-4.1.0              |       h2733197_0         447 KB\n","    libunistring-0.9.10        |       h27cfd23_0         536 KB\n","    libuv-1.40.0               |       h7b6447c_0         736 KB\n","    mkl-2021.2.0               |     h06a4308_296       144.3 MB\n","    mkl-service-2.3.0          |   py37h27cfd23_1          55 KB\n","    mkl_fft-1.3.0              |   py37h42c9631_2         170 KB\n","    mkl_random-1.2.1           |   py37ha9443f7_2         287 KB\n","    nettle-3.7.3               |       hbbd107a_1         809 KB\n","    ninja-1.10.2               |       hff7bd54_1         1.4 MB\n","    numpy-1.20.2               |   py37h2d18471_0          23 KB\n","    numpy-base-1.20.2          |   py37hfae3a4d_0         4.5 MB\n","    olefile-0.46               |           py37_0          50 KB\n","    openh264-2.1.0             |       hd408876_0         722 KB\n","    pillow-8.2.0               |   py37he98fc37_0         622 KB\n","    pytorch-1.8.1              |py3.7_cuda10.2_cudnn7.6.5_0       673.5 MB  pytorch\n","    torchaudio-0.8.1           |             py37         4.4 MB  pytorch\n","    torchvision-0.9.1          |       py37_cu102        25.7 MB  pytorch\n","    typing_extensions-3.7.4.3  |     pyha847dfd_0          25 KB\n","    zstd-1.3.7                 |       h0b5b093_0         401 KB\n","    ------------------------------------------------------------\n","                                           Total:       874.1 MB\n","\n","The following NEW packages will be INSTALLED:\n","\n","  blas               pkgs/main/linux-64::blas-1.0-mkl\n","  bzip2              pkgs/main/linux-64::bzip2-1.0.8-h7b6447c_0\n","  ffmpeg             pytorch/linux-64::ffmpeg-4.3-hf484d3e_0\n","  freetype           pkgs/main/linux-64::freetype-2.10.4-h5ab3b9f_0\n","  gmp                pkgs/main/linux-64::gmp-6.2.1-h2531618_2\n","  gnutls             pkgs/main/linux-64::gnutls-3.6.15-he1e5248_0\n","  intel-openmp       pkgs/main/linux-64::intel-openmp-2021.2.0-h06a4308_610\n","  jpeg               pkgs/main/linux-64::jpeg-9b-h024ee3a_2\n","  lame               pkgs/main/linux-64::lame-3.100-h7b6447c_0\n","  lcms2              pkgs/main/linux-64::lcms2-2.12-h3be6417_0\n","  libiconv           pkgs/main/linux-64::libiconv-1.15-h63c8f33_5\n","  libidn2            pkgs/main/linux-64::libidn2-2.3.1-h27cfd23_0\n","  libpng             pkgs/main/linux-64::libpng-1.6.37-hbc83047_0\n","  libtasn1           pkgs/main/linux-64::libtasn1-4.16.0-h27cfd23_0\n","  libtiff            pkgs/main/linux-64::libtiff-4.1.0-h2733197_0\n","  libunistring       pkgs/main/linux-64::libunistring-0.9.10-h27cfd23_0\n","  libuv              pkgs/main/linux-64::libuv-1.40.0-h7b6447c_0\n","  mkl                pkgs/main/linux-64::mkl-2021.2.0-h06a4308_296\n","  mkl-service        pkgs/main/linux-64::mkl-service-2.3.0-py37h27cfd23_1\n","  mkl_fft            pkgs/main/linux-64::mkl_fft-1.3.0-py37h42c9631_2\n","  mkl_random         pkgs/main/linux-64::mkl_random-1.2.1-py37ha9443f7_2\n","  nettle             pkgs/main/linux-64::nettle-3.7.3-hbbd107a_1\n","  ninja              pkgs/main/linux-64::ninja-1.10.2-hff7bd54_1\n","  numpy              pkgs/main/linux-64::numpy-1.20.2-py37h2d18471_0\n","  numpy-base         pkgs/main/linux-64::numpy-base-1.20.2-py37hfae3a4d_0\n","  olefile            pkgs/main/linux-64::olefile-0.46-py37_0\n","  openh264           pkgs/main/linux-64::openh264-2.1.0-hd408876_0\n","  pillow             pkgs/main/linux-64::pillow-8.2.0-py37he98fc37_0\n","  pytorch            pytorch/linux-64::pytorch-1.8.1-py3.7_cuda10.2_cudnn7.6.5_0\n","  torchaudio         pytorch/linux-64::torchaudio-0.8.1-py37\n","  torchvision        pytorch/linux-64::torchvision-0.9.1-py37_cu102\n","  typing_extensions  pkgs/main/noarch::typing_extensions-3.7.4.3-pyha847dfd_0\n","  zstd               pkgs/main/linux-64::zstd-1.3.7-h0b5b093_0\n","\n","\n","\n","Downloading and Extracting Packages\n","libiconv-1.15        | 721 KB    | : 100% 1.0/1 [00:00\u003c00:00,  7.86it/s]\n","torchaudio-0.8.1     | 4.4 MB    | : 100% 1.0/1 [00:00\u003c00:00,  1.22it/s]              \n","openh264-2.1.0       | 722 KB    | : 100% 1.0/1 [00:00\u003c00:00, 11.66it/s]\n","mkl_fft-1.3.0        | 170 KB    | : 100% 1.0/1 [00:00\u003c00:00, 20.05it/s]\n","jpeg-9b              | 214 KB    | : 100% 1.0/1 [00:00\u003c00:00, 18.35it/s]\n","pytorch-1.8.1        | 673.5 MB  | : 100% 1.0/1 [01:35\u003c00:00, 95.68s/it]               \n","libidn2-2.3.1        | 85 KB     | : 100% 1.0/1 [00:00\u003c00:00,  8.61it/s]\n","intel-openmp-2021.2. | 1.3 MB    | : 100% 1.0/1 [00:00\u003c00:00, 11.67it/s]\n","gmp-6.2.1            | 539 KB    | : 100% 1.0/1 [00:00\u003c00:00, 13.41it/s]\n","bzip2-1.0.8          | 78 KB     | : 100% 1.0/1 [00:00\u003c00:00, 20.01it/s]\n","lame-3.100           | 323 KB    | : 100% 1.0/1 [00:00\u003c00:00, 19.58it/s]\n","blas-1.0             | 6 KB      | : 100% 1.0/1 [00:00\u003c00:00, 23.47it/s]\n","nettle-3.7.3         | 809 KB    | : 100% 1.0/1 [00:00\u003c00:00, 14.71it/s]\n","ninja-1.10.2         | 1.4 MB    | : 100% 1.0/1 [00:00\u003c00:00, 13.49it/s]\n","freetype-2.10.4      | 596 KB    | : 100% 1.0/1 [00:00\u003c00:00, 17.46it/s]\n","zstd-1.3.7           | 401 KB    | : 100% 1.0/1 [00:00\u003c00:00, 19.83it/s]\n","mkl-service-2.3.0    | 55 KB     | : 100% 1.0/1 [00:00\u003c00:00, 22.41it/s]\n","gnutls-3.6.15        | 1.0 MB    | : 100% 1.0/1 [00:00\u003c00:00, 10.46it/s]\n","lcms2-2.12           | 312 KB    | : 100% 1.0/1 [00:00\u003c00:00, 18.61it/s]\n","libuv-1.40.0         | 736 KB    | : 100% 1.0/1 [00:00\u003c00:00, 10.23it/s]\n","typing_extensions-3. | 25 KB     | : 100% 1.0/1 [00:00\u003c00:00, 28.32it/s]\n","torchvision-0.9.1    | 25.7 MB   | : 100% 1.0/1 [00:04\u003c00:00,  4.29s/it]               \n","libunistring-0.9.10  | 536 KB    | : 100% 1.0/1 [00:00\u003c00:00, 18.51it/s]\n","libtiff-4.1.0        | 447 KB    | : 100% 1.0/1 [00:00\u003c00:00, 18.04it/s]\n","libpng-1.6.37        | 278 KB    | : 100% 1.0/1 [00:00\u003c00:00, 21.74it/s]\n","pillow-8.2.0         | 622 KB    | : 100% 1.0/1 [00:00\u003c00:00, 15.93it/s]\n","numpy-1.20.2         | 23 KB     | : 100% 1.0/1 [00:00\u003c00:00, 25.80it/s]\n","mkl-2021.2.0         | 144.3 MB  | : 100% 1.0/1 [00:07\u003c00:00,  7.17s/it]               \n","numpy-base-1.20.2    | 4.5 MB    | : 100% 1.0/1 [00:00\u003c00:00,  4.07it/s]\n","olefile-0.46         | 50 KB     | : 100% 1.0/1 [00:00\u003c00:00, 18.62it/s]\n","mkl_random-1.2.1     | 287 KB    | : 100% 1.0/1 [00:00\u003c00:00, 20.55it/s]\n","libtasn1-4.16.0      | 58 KB     | : 100% 1.0/1 [00:00\u003c00:00, 19.23it/s]\n","ffmpeg-4.3           | 9.9 MB    | : 100% 1.0/1 [00:01\u003c00:00,  1.37s/it]\n","Preparing transaction: | \u0008\u0008/ \u0008\u0008- \u0008\u0008done\n","Verifying transaction: | \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Executing transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008done\n","Collecting package metadata (current_repodata.json): - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Solving environment: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - matplotlib\n","\n","\n","The following packages will be downloaded:\n","\n","    package                    |            build\n","    ---------------------------|-----------------\n","    cycler-0.10.0              |           py37_0          13 KB\n","    dbus-1.13.18               |       hb2f20db_0         504 KB\n","    expat-2.4.1                |       h2531618_2         168 KB\n","    fontconfig-2.13.1          |       h6c09931_0         250 KB\n","    glib-2.68.2                |       h36276a3_0         3.0 MB\n","    gst-plugins-base-1.14.0    |       h8213a91_2         4.9 MB\n","    gstreamer-1.14.0           |       h28cd5cc_2         3.2 MB\n","    icu-58.2                   |       he6710b0_3        10.5 MB\n","    kiwisolver-1.3.1           |   py37h2531618_0          80 KB\n","    libffi-3.3                 |       he6710b0_2          50 KB\n","    libuuid-1.0.3              |       h1bed415_2          15 KB\n","    libxcb-1.14                |       h7b6447c_0         505 KB\n","    libxml2-2.9.10             |       hb55368b_3         1.2 MB\n","    matplotlib-3.3.4           |   py37h06a4308_0          26 KB\n","    matplotlib-base-3.3.4      |   py37h62a2d02_0         5.1 MB\n","    pcre-8.44                  |       he6710b0_0         212 KB\n","    pyparsing-2.4.7            |     pyhd3eb1b0_0          59 KB\n","    pyqt-5.9.2                 |   py37h05f1152_2         4.5 MB\n","    python-dateutil-2.8.1      |     pyhd3eb1b0_0         221 KB\n","    qt-5.9.7                   |       h5867ecd_1        68.5 MB\n","    sip-4.19.8                 |   py37hf484d3e_0         274 KB\n","    tornado-6.1                |   py37h27cfd23_0         589 KB\n","    xz-5.2.5                   |       h7b6447c_0         341 KB\n","    ------------------------------------------------------------\n","                                           Total:       104.1 MB\n","\n","The following NEW packages will be INSTALLED:\n","\n","  cycler             pkgs/main/linux-64::cycler-0.10.0-py37_0\n","  dbus               pkgs/main/linux-64::dbus-1.13.18-hb2f20db_0\n","  expat              pkgs/main/linux-64::expat-2.4.1-h2531618_2\n","  fontconfig         pkgs/main/linux-64::fontconfig-2.13.1-h6c09931_0\n","  glib               pkgs/main/linux-64::glib-2.68.2-h36276a3_0\n","  gst-plugins-base   pkgs/main/linux-64::gst-plugins-base-1.14.0-h8213a91_2\n","  gstreamer          pkgs/main/linux-64::gstreamer-1.14.0-h28cd5cc_2\n","  icu                pkgs/main/linux-64::icu-58.2-he6710b0_3\n","  kiwisolver         pkgs/main/linux-64::kiwisolver-1.3.1-py37h2531618_0\n","  libuuid            pkgs/main/linux-64::libuuid-1.0.3-h1bed415_2\n","  libxcb             pkgs/main/linux-64::libxcb-1.14-h7b6447c_0\n","  libxml2            pkgs/main/linux-64::libxml2-2.9.10-hb55368b_3\n","  matplotlib         pkgs/main/linux-64::matplotlib-3.3.4-py37h06a4308_0\n","  matplotlib-base    pkgs/main/linux-64::matplotlib-base-3.3.4-py37h62a2d02_0\n","  pcre               pkgs/main/linux-64::pcre-8.44-he6710b0_0\n","  pyparsing          pkgs/main/noarch::pyparsing-2.4.7-pyhd3eb1b0_0\n","  pyqt               pkgs/main/linux-64::pyqt-5.9.2-py37h05f1152_2\n","  python-dateutil    pkgs/main/noarch::python-dateutil-2.8.1-pyhd3eb1b0_0\n","  qt                 pkgs/main/linux-64::qt-5.9.7-h5867ecd_1\n","  sip                pkgs/main/linux-64::sip-4.19.8-py37hf484d3e_0\n","  tornado            pkgs/main/linux-64::tornado-6.1-py37h27cfd23_0\n","\n","The following packages will be UPDATED:\n","\n","  libffi                                   3.2.1-hd88cf55_4 --\u003e 3.3-he6710b0_2\n","  xz                                       5.2.4-h14c3975_4 --\u003e 5.2.5-h7b6447c_0\n","\n","\n","\n","Downloading and Extracting Packages\n","icu-58.2             | 10.5 MB   | : 100% 1.0/1 [00:00\u003c00:00,  2.62it/s]\n","gst-plugins-base-1.1 | 4.9 MB    | : 100% 1.0/1 [00:00\u003c00:00,  1.65it/s]\n","glib-2.68.2          | 3.0 MB    | : 100% 1.0/1 [00:00\u003c00:00,  6.34it/s]\n","xz-5.2.5             | 341 KB    | : 100% 1.0/1 [00:00\u003c00:00, 15.18it/s]\n","pyparsing-2.4.7      | 59 KB     | : 100% 1.0/1 [00:00\u003c00:00, 34.80it/s]\n","libuuid-1.0.3        | 15 KB     | : 100% 1.0/1 [00:00\u003c00:00, 22.18it/s]\n","sip-4.19.8           | 274 KB    | : 100% 1.0/1 [00:00\u003c00:00, 16.39it/s]\n","tornado-6.1          | 589 KB    | : 100% 1.0/1 [00:00\u003c00:00, 13.77it/s]\n","python-dateutil-2.8. | 221 KB    | : 100% 1.0/1 [00:00\u003c00:00, 21.53it/s]\n","pcre-8.44            | 212 KB    | : 100% 1.0/1 [00:00\u003c00:00, 18.66it/s]\n","fontconfig-2.13.1    | 250 KB    | : 100% 1.0/1 [00:00\u003c00:00, 21.09it/s]\n","gstreamer-1.14.0     | 3.2 MB    | : 100% 1.0/1 [00:00\u003c00:00,  7.53it/s]\n","libxcb-1.14          | 505 KB    | : 100% 1.0/1 [00:00\u003c00:00, 14.97it/s]\n","matplotlib-3.3.4     | 26 KB     | : 100% 1.0/1 [00:00\u003c00:00, 20.38it/s]\n","libxml2-2.9.10       | 1.2 MB    | : 100% 1.0/1 [00:00\u003c00:00, 10.59it/s]\n","expat-2.4.1          | 168 KB    | : 100% 1.0/1 [00:00\u003c00:00, 16.92it/s]\n","qt-5.9.7             | 68.5 MB   | : 100% 1.0/1 [00:03\u003c00:00,  3.03s/it]\n","matplotlib-base-3.3. | 5.1 MB    | : 100% 1.0/1 [00:00\u003c00:00,  2.22it/s]\n","cycler-0.10.0        | 13 KB     | : 100% 1.0/1 [00:00\u003c00:00, 14.94it/s]\n","kiwisolver-1.3.1     | 80 KB     | : 100% 1.0/1 [00:00\u003c00:00, 21.54it/s]\n","libffi-3.3           | 50 KB     | : 100% 1.0/1 [00:00\u003c00:00, 19.88it/s]\n","pyqt-5.9.2           | 4.5 MB    | : 100% 1.0/1 [00:00\u003c00:00,  4.01it/s]\n","dbus-1.13.18         | 504 KB    | : 100% 1.0/1 [00:00\u003c00:00, 13.54it/s]\n","Preparing transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008done\n","Verifying transaction: | \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Executing transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008done\n","Collecting package metadata (current_repodata.json): - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008done\n","Solving environment: | \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008failed with initial frozen solve. Retrying with flexible solve.\n","Solving environment: / \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008failed with repodata from current_repodata.json, will retry with next repodata source.\n","Collecting package metadata (repodata.json): \\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008done\n","Solving environment: / \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - rdkit==2020.03.3\n","\n","\n","The following packages will be downloaded:\n","\n","    package                    |            build\n","    ---------------------------|-----------------\n","    cairo-1.16.0               |       hf32fb01_1         1.0 MB\n","    cffi-1.14.5                |   py37h261ae71_0         224 KB\n","    libboost-1.67.0            |       h46d08c1_4        13.0 MB\n","    pandas-1.2.4               |   py37h2531618_0         8.5 MB\n","    pixman-0.40.0              |       h7b6447c_0         370 KB\n","    py-boost-1.67.0            |   py37h04863e7_4         278 KB\n","    python-3.7.7               |       hcff3b4d_5        45.1 MB\n","    pytz-2021.1                |     pyhd3eb1b0_0         181 KB\n","    rdkit-2020.03.3.0          |   py37hc20afe1_1        24.8 MB  rdkit\n","    readline-8.1               |       h27cfd23_0         362 KB\n","    ------------------------------------------------------------\n","                                           Total:        93.9 MB\n","\n","The following NEW packages will be INSTALLED:\n","\n","  cairo              pkgs/main/linux-64::cairo-1.16.0-hf32fb01_1\n","  libboost           pkgs/main/linux-64::libboost-1.67.0-h46d08c1_4\n","  pandas             pkgs/main/linux-64::pandas-1.2.4-py37h2531618_0\n","  pixman             pkgs/main/linux-64::pixman-0.40.0-h7b6447c_0\n","  py-boost           pkgs/main/linux-64::py-boost-1.67.0-py37h04863e7_4\n","  pytz               pkgs/main/noarch::pytz-2021.1-pyhd3eb1b0_0\n","  rdkit              rdkit/linux-64::rdkit-2020.03.3.0-py37hc20afe1_1\n","\n","The following packages will be UPDATED:\n","\n","  cffi                                1.14.0-py37h2e261b9_0 --\u003e 1.14.5-py37h261ae71_0\n","  python                                   3.7.6-h0371630_2 --\u003e 3.7.7-hcff3b4d_5\n","  readline                                   7.0-h7b6447c_5 --\u003e 8.1-h27cfd23_0\n","\n","\n","\n","Downloading and Extracting Packages\n","pandas-1.2.4         | 8.5 MB    | : 100% 1.0/1 [00:00\u003c00:00,  1.80it/s]\n","cffi-1.14.5          | 224 KB    | : 100% 1.0/1 [00:00\u003c00:00, 11.11it/s]\n","pixman-0.40.0        | 370 KB    | : 100% 1.0/1 [00:00\u003c00:00, 14.33it/s]\n","cairo-1.16.0         | 1.0 MB    | : 100% 1.0/1 [00:00\u003c00:00, 11.08it/s]\n","python-3.7.7         | 45.1 MB   | : 100% 1.0/1 [00:01\u003c00:00,  1.21s/it]\n","pytz-2021.1          | 181 KB    | : 100% 1.0/1 [00:00\u003c00:00, 10.37it/s]\n","rdkit-2020.03.3.0    | 24.8 MB   | : 100% 1.0/1 [00:03\u003c00:00,  3.85s/it]\n","libboost-1.67.0      | 13.0 MB   | : 100% 1.0/1 [00:01\u003c00:00,  1.72s/it]               \n","readline-8.1         | 362 KB    | : 100% 1.0/1 [00:00\u003c00:00,  2.79it/s]\n","py-boost-1.67.0      | 278 KB    | : 100% 1.0/1 [00:00\u003c00:00,  9.41it/s]\n","Preparing transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Verifying transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n","Executing transaction: - \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008/ \u0008\u0008- \u0008\u0008\\ \u0008\u0008| \u0008\u0008done\n"]}],"source":["! conda install cudnn==7.6.5 -y\n","! conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch -y\n","! conda install matplotlib -y\n","! conda install -c rdkit rdkit==2020.03.3 -y"]},{"cell_type":"markdown","metadata":{"id":"x2Fc8SfuK76B"},"source":["## Code Execution"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"qTjOe8_FK672"},"outputs":[{"name":"stdout","output_type":"stream","text":["Device = cuda\n","Total number of parameters in network: 21200936\n","Dataset size: torch.Size([11215146, 1, 40])\n","Integer dataset size: torch.Size([11215146])\n","Each epoch has 584 batches, aka iterations.\n","Loss: 0.049757 | Delta: +3.7318 | Iteration: 000001 | Time elapsed: 000 h 00 m 12 s\n","Loss: 0.035543 | Delta: +0.0031 | Iteration: 000011 | Time elapsed: 000 h 01 m 51 s\n","Loss: 0.035297 | Delta: -0.0000 | Iteration: 000021 | Time elapsed: 000 h 03 m 30 s\n","Loss: 0.035192 | Delta: -0.0014 | Iteration: 000031 | Time elapsed: 000 h 05 m 10 s\n","Loss: 0.035229 | Delta: -0.0011 | Iteration: 000041 | Time elapsed: 000 h 06 m 50 s\n","Loss: 0.035205 | Delta: -0.0015 | Iteration: 000051 | Time elapsed: 000 h 08 m 30 s\n","Loss: 0.035161 | Delta: -0.0006 | Iteration: 000061 | Time elapsed: 000 h 10 m 10 s\n","Loss: 0.035132 | Delta: -0.0016 | Iteration: 000071 | Time elapsed: 000 h 11 m 50 s\n","Loss: 0.034993 | Delta: -0.0004 | Iteration: 000081 | Time elapsed: 000 h 13 m 29 s\n","Loss: 0.034994 | Delta: -0.0016 | Iteration: 000091 | Time elapsed: 000 h 15 m 09 s\n","Loss: 0.034914 | Delta: -0.0039 | Iteration: 000101 | Time elapsed: 000 h 16 m 49 s\n","Loss: 0.034949 | Delta: +0.0001 | Iteration: 000111 | Time elapsed: 000 h 18 m 29 s\n","Loss: 0.034912 | Delta: -0.0024 | Iteration: 000121 | Time elapsed: 000 h 20 m 09 s\n","Loss: 0.034917 | Delta: +0.0004 | Iteration: 000131 | Time elapsed: 000 h 21 m 48 s\n","Loss: 0.034829 | Delta: -0.0006 | Iteration: 000141 | Time elapsed: 000 h 23 m 28 s\n"]},{"ename":"KeyboardInterrupt","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-4-d5b2fd4ee466\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     26\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mModel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnum_layers\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdropout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     27\u001b[0m \u001b[0;31m# Train the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 28\u001b[0;31m \u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata_list\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mint_data_list\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepochs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel_name\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"network.pth\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput_file\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'training.txt'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnew_session\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     29\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     30\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/content/drive/MyDrive/Università/Models/Yasonik/LSTM.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(model, data, int_data, epochs, model_name, output_file, new_session)\u001b[0m\n\u001b[1;32m    134\u001b[0m         \u001b[0;31m# Train\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    135\u001b[0m         count = train_epoch(model, data, int_data, optimizer, criterion, model_name=model_name, output_file=output_file,\n\u001b[0;32m--\u003e 136\u001b[0;31m                     count=count, t_final=t_final)\n\u001b[0m\u001b[1;32m    137\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    138\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/content/drive/MyDrive/Università/Models/Yasonik/LSTM.py\u001b[0m in \u001b[0;36mtrain_epoch\u001b[0;34m(model, data_list, int_data_list, optimizer, criterion, model_name, output_file, count, t_final)\u001b[0m\n\u001b[1;32m     77\u001b[0m                 \u001b[0mtarget_data\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtarget_data\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcuda\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     78\u001b[0m             \u001b[0;31m# Run model, calculate loss\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 79\u001b[0;31m             \u001b[0moutput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     80\u001b[0m             \u001b[0mloss\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0mcriterion\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msqueeze\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtarget_data\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msqueeze\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     81\u001b[0m             \u001b[0;31m# Back propagate loss\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    887\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    888\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 889\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    890\u001b[0m         for hook in itertools.chain(\n\u001b[1;32m    891\u001b[0m                 \u001b[0m_global_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/content/drive/MyDrive/Università/Models/Yasonik/LSTM.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, inp, hidden)\u001b[0m\n\u001b[1;32m     41\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minp\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     42\u001b[0m         \u001b[0;31m# LSTM\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 43\u001b[0;31m         \u001b[0moutput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlstm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minp\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     44\u001b[0m         \u001b[0;31m# Linear Layer\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     45\u001b[0m         \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinear\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    887\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    888\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 889\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    890\u001b[0m         for hook in itertools.chain(\n\u001b[1;32m    891\u001b[0m                 \u001b[0m_global_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/torch/nn/modules/rnn.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input, hx)\u001b[0m\n\u001b[1;32m    660\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mbatch_sizes\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    661\u001b[0m             result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,\n\u001b[0;32m--\u003e 662\u001b[0;31m                               self.dropout, self.training, self.bidirectional, self.batch_first)\n\u001b[0m\u001b[1;32m    663\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    664\u001b[0m             result = _VF.lstm(input, batch_sizes, hx, self._flat_weights, self.bias,\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["# Import packages\n","from DataPreprocessing import pre_processing\n","import numpy as np\n","from Modules.config import *\n","from LSTM import Model, train, load_model\n","from Modules.utils import load_data, load_vocab\n","from Generator import generate_molecules\n","from DataPostprocessing import post_processing\n","\n","# PRE-PROCESS DATA ====================================================================\n","# # Pre-process the data\n","# data_list, int_data_list, input_size = pre_processing(filename='CHEMBL_FULL_DATASET.txt', division=3, vocab=True)\n","# print(data_list)\n","# print(int_data_list)\n","# print(input_size)\n","\n","data_list = ['ohesmiles_0.npz', 'ohesmiles_1.npz', 'ohesmiles_2.npz']\n","int_data_list = ['intsmiles_0.npz', 'intsmiles_1.npz', 'intsmiles_2.npz']\n","input_size = 40\n","\n","# TRAIN NEW MODEL =====================================================================\n","# # Load the data\n","# data, int_data = load_data(\"ohesmiles.npz\", \"intsmiles.npz\")\n","# input_size = np.shape(data)[2]\n","# Instantiate the model\n","model = Model(input_size, hidden_size, num_layers, dropout)\n","# Train the model\n","train(model, data_list, int_data_list, epochs=2, model_name=\"network.pth\", output_file='training.txt', new_session=True)\n","\n","\n","# # TRAIN MODEL ==========================================================================\n","# # Load the data\n","# data, int_data = load_data(\"ohesmiles.npz\", \"intsmiles.npz\")\n","# input_size = np.shape(data)[2]\n","# # Instantiate the model\n","# model = Model(input_size, hidden_size, num_layers, dropout)\n","# # Load Model\n","# model = load_model(model, model_file='network.pth')\n","# # Improve model\n","# train(model, data, int_data, epochs=1, model_name='network.pth', output_file='training.txt', new_session=False)\n","\n","\n","# # GENERATE MOLECULES ===================================================================\n","# # Instantiate the model\n","# model = Model(input_size, hidden_size, num_layers, dropout)\n","# # Load Model\n","# model = load_model(model, model_file='network.pth')\n","# # Load the data and vocab\n","# data, _ = load_data(\"ohesmiles.npz\", single_input=True)\n","# vocab = load_vocab()\n","# # Initialize model and generation parameters\n","# input_size = np.shape(data)[2]\n","# # Generate molecules\n","# generate_molecules(model, vocab, temperature=1, char_to_gen=3000, runs=100, gen_filename='gen.txt')\n","# # Post_processing\n","# post_processing(num_random_molecules=5)\n","\n","# # FINE TUNING ============================================================================\n","# # Load the data\n","# data, int_data = load_data(\"ohefinemols.npz\", \"intfinemols.npz\", folder=results_folder)\n","# # Initialize model parameters\n","# input_size = np.shape(data)[2]\n","# # Call model, set optimizer and loss function\n","# model = Model(input_size, hidden_size, num_layers, dropout)\n","# # Load Model\n","# model = load_model(model, model_file='network.pth')\n","# # Improve model\n","# train(model, data, int_data, epochs=1, model_name='network1.pth', output_file='training_tuned.txt', new_session=True)"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"name":"Script Yasonik","provenance":[{"file_id":"https://github.com/dataprofessor/code/blob/master/python/google_colab_install_conda.ipynb","timestamp":1622912098906}],"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}